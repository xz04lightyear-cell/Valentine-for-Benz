<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Valentine Crossword</title>

<style>
  :root{
    --bg1:#fff0f6;
    --bg2:#ffe8f1;
    --ink:#1a1a1a;
    --pink:#ff4d8d;
    --card:#ffffffcc;
    --shadow: 0 18px 50px rgba(255,77,141,.18);

    --cell-bg:#fff6fb;
    --cell-border:#ffb3d1;
    --cell-shadow: 0 10px 22px rgba(255,77,141,.10);

    --cell-ok-bg:#eafff0;
    --cell-ok-border:#1a7f37;

    --cell-bad-bg:#ffe8ec;
    --cell-bad-border:#d1242f;
  }

  body{
    font-family: system-ui;
    padding: 28px;
    color: var(--ink);
    background:
      radial-gradient(900px 600px at 15% 10%, rgba(255,77,141,.18), transparent 60%),
      radial-gradient(900px 600px at 90% 15%, rgba(255,120,168,.18), transparent 60%),
      radial-gradient(900px 600px at 50% 100%, rgba(255,200,220,.25), transparent 60%),
      linear-gradient(180deg, var(--bg1), var(--bg2));
  }

  body::before{
    content:"";
    position:fixed;
    inset:0;
    pointer-events:none;
    opacity:.18;
    background-image:
      radial-gradient(circle at 10px 10px, rgba(255,77,141,.35) 2px, transparent 2.2px),
      radial-gradient(circle at 30px 22px, rgba(255,120,168,.28) 2px, transparent 2.2px);
    background-size: 44px 44px;
    filter: blur(.2px);
  }

  .grid{
    width: fit-content;
    margin: 0 auto;
    padding: 18px;
    border-radius: 22px;
    background: var(--card);
    box-shadow: var(--shadow);
    border: 1px solid rgba(255,77,141,.18);

    display:grid;
    grid-template-columns: 280px repeat(13, 56px);
    grid-template-rows: 110px repeat(10, 64px);
    gap:14px;
    align-items:center;
    justify-items:center;

    /* ‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏ß‡πÉ‡∏à‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÉ‡∏ô‡πÄ‡∏Å‡∏° */
    position: relative;
    overflow: hidden;
  }

  /* ‚úÖ BIG HEART BACKGROUND (‡∏à‡∏≤‡∏á‡πÜ) */
  .grid::before{
    content:"";
    position:absolute;
    inset:-20px;
    pointer-events:none;
    z-index:0;

    background-image: url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' width='420' height='320' viewBox='0 0 420 320'>\
  <path d='M210 292C210 292 60 205 60 120C60 76 92 46 136 46C165 46 192 62 210 84C228 62 255 46 284 46C328 46 360 76 360 120C360 205 210 292 210 292Z' fill='%23ff4d8d' fill-opacity='0.075'/>\
</svg>");
    background-repeat: repeat;
    background-size: 320px 240px;
    background-position: center;

    filter: blur(.15px);
  }

  /* ‡πÉ‡∏´‡πâ‡∏Ç‡∏≠‡∏á‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏ß‡πÉ‡∏à */
  .grid > *{
    position: relative;
    z-index: 1;
  }

  input.cell{
    width:56px; height:64px;
    font-size:28px;
    text-align:center;
    border:2px solid var(--cell-border);
    border-radius:14px;
    outline:none;
    background: var(--cell-bg);
    text-transform: uppercase;
    box-shadow: var(--cell-shadow);
    transition: transform .08s ease, box-shadow .15s ease, border-color .15s ease, background .15s ease;
  }
  input.cell:focus{
    border-color: var(--pink);
    box-shadow: 0 0 0 6px rgba(255,77,141,.18);
    transform: translateY(-1px);
  }

  input.correct{ border-color: var(--cell-ok-border); background: var(--cell-ok-bg); }
  input.wrong{ border-color: var(--cell-bad-border); background: var(--cell-bad-bg); }

  /* ===== CALLOUTS ===== */
  .callout-left, .callout-top, .callout-right{
    position:relative;
    padding:10px 12px;
    border:2px solid rgba(20,20,20,.92);
    border-radius:16px;
    font-size:14px;
    font-weight:700;
    background:#fff;
    text-align:center;

    line-height:1.25;
    max-width: 260px;
    white-space: normal;
    overflow-wrap: normal;
    word-break: keep-all;
    hyphens: none;

    z-index: 2;
    box-shadow: 0 12px 30px rgba(0,0,0,.08);
  }

  /* left arrow -> */
  .callout-left{
    justify-self:end;
    margin-right:6px;
  }
  .callout-left::after{
    content:"";
    position:absolute;
    right:-14px; top:50%;
    transform:translateY(-50%);
    border-top:10px solid transparent;
    border-bottom:10px solid transparent;
    border-left:14px solid rgba(20,20,20,.92);
  }
  .callout-left::before{
    content:"";
    position:absolute;
    right:-12px; top:50%;
    transform:translateY(-50%);
    border-top:8px solid transparent;
    border-bottom:8px solid transparent;
    border-left:12px solid #fff;
    z-index:1;
  }

  /* right arrow <- */
  .callout-right{
    justify-self:start;
    margin-left:6px;
  }
  .callout-right::after{
    content:"";
    position:absolute;
    left:-14px; top:50%;
    transform:translateY(-50%);
    border-top:10px solid transparent;
    border-bottom:10px solid transparent;
    border-right:14px solid rgba(20,20,20,.92);
  }
  .callout-right::before{
    content:"";
    position:absolute;
    left:-12px; top:50%;
    transform:translateY(-50%);
    border-top:8px solid transparent;
    border-bottom:8px solid transparent;
    border-right:12px solid #fff;
    z-index:1;
  }

  /* top arrow v */
  .callout-top::after{
    content:"";
    position:absolute;
    left:50%; bottom:-14px;
    transform:translateX(-50%);
    border-left:10px solid transparent;
    border-right:10px solid transparent;
    border-top:14px solid rgba(20,20,20,.92);
  }
  .callout-top::before{
    content:"";
    position:absolute;
    left:50%; bottom:-12px;
    transform:translateX(-50%);
    border-left:8px solid transparent;
    border-right:8px solid transparent;
    border-top:12px solid #fff;
    z-index:1;
  }

  #q4, #q10 { font-size: 13px; max-width: 280px; }
  #q2, #q9{
    white-space: nowrap;
    max-width: none;
    width: max-content;
    padding: 10px 14px;
  }

  /* ====== POSITIONS ====== */
  #q1 { grid-column:2; grid-row:5; }
  #q2 { grid-column:3; grid-row:3; transform:none; }
  #q3 { grid-column:5; grid-row:4; max-width:190px; transform:translateY(-18px); }
  #q4 { grid-column:7; grid-row:1; transform:translateY(-8px); }
  #q5 { grid-column:2; grid-row:8; }
  #q6 { grid-column:4; grid-row:10; }
  #q7 { grid-column:3; grid-row:2; }
  #q8 { grid-column:10; grid-row:7; transform:translateY(-26px); }
  #q9 { grid-column:12; grid-row:5; transform:none; }
  #q10{ grid-column:12; grid-row:4; }

  /* ====== TILE POSITIONS ====== */
  #h1 { grid-column:3; grid-row:5; } #h2 { grid-column:4; grid-row:5; }
  #h3 { grid-column:5; grid-row:5; } #h4 { grid-column:6; grid-row:5; }
  #h5 { grid-column:7; grid-row:5; }

  #o1 { grid-column:3; grid-row:4; } #i1 { grid-column:3; grid-row:6; }

  #v2 { grid-column:5; grid-row:6; } #v3 { grid-column:5; grid-row:7; } #v4 { grid-column:5; grid-row:8; }

  #bgB { grid-column:7; grid-row:2; } #bgO { grid-column:7; grid-row:3; } #bgA1{ grid-column:7; grid-row:4; }
  #bgD { grid-column:7; grid-row:6; } #bgG { grid-column:7; grid-row:7; } #bgA2{ grid-column:7; grid-row:8; }
  #bgM { grid-column:7; grid-row:9; } #bgE { grid-column:7; grid-row:10;}

  #t1 { grid-column:3; grid-row:8; } #t2 { grid-column:4; grid-row:8; }
  #t4 { grid-column:6; grid-row:8; } #t6 { grid-column:8; grid-row:8; }

  #el1 { grid-column:5;  grid-row:10; } #el2 { grid-column:6;  grid-row:10; }
  #el4 { grid-column:8;  grid-row:10; } #el5 { grid-column:9;  grid-row:10; }
  #el6 { grid-column:10; grid-row:10; } #el7 { grid-column:11; grid-row:10; } #el8 { grid-column:12; grid-row:10; }

  #sh1 { grid-column:4; grid-row:2; } #sh2 { grid-column:5; grid-row:2; }
  #sh3 { grid-column:6; grid-row:2; } #sh5 { grid-column:8; grid-row:2; }

  #se1 { grid-column:10; grid-row:8; } #se2 { grid-column:10; grid-row:9; }

  #ei1 { grid-column:12; grid-row:6; } #ei2 { grid-column:12; grid-row:7; }
  #ei3 { grid-column:12; grid-row:8; } #ei4 { grid-column:12; grid-row:9; }

  #an2 { grid-column:8;  grid-row:4; } #an3 { grid-column:9;  grid-row:4; }
  #an4 { grid-column:10; grid-row:4; } #an5 { grid-column:11; grid-row:4; }

  /* ===== WIN POPUP ===== */
  .overlay{
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.25);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index: 9999;
  }
  .overlay[hidden]{ display:none !important; }

  .modal{
    background:#fff;
    border:2px solid rgba(20,20,20,.92);
    border-radius:22px;
    padding:18px 18px 14px;
    min-width: 300px;
    text-align:center;
    box-shadow: 0 18px 50px rgba(0,0,0,.18);
  }
  .modal .title{
    font-weight:900;
    font-size:26px;
    letter-spacing:.5px;
    margin-bottom:8px;
  }
  .modal .msg{
    font-weight:700;
    opacity:.85;
    margin-bottom:14px;
    line-height:1.55;
  }
  .btn{
    border:2px solid rgba(20,20,20,.92);
    background:#fff;
    border-radius:16px;
    padding:8px 16px;
    font-weight:900;
    cursor:pointer;
  }
  .btn:hover{ transform: translateY(-1px); }
</style>
</head>

<body>
<div class="grid">
  <div class="callout-left"  id="q7">Food we often eat together?</div>
  <div class="callout-top"   id="q4">Something we never thought we'd enjoy together?</div>
  <div class="callout-top"   id="q2">How did we meet?</div>
  <div class="callout-top"   id="q3">Month we started dating?</div>
  <div class="callout-left"  id="q1">First place we met?</div>
  <div class="callout-left"  id="q5">What we call each other?</div>
  <div class="callout-left"  id="q6">What‚Äôs in the fridge?</div>
  <div class="callout-top"   id="q8">The first place we took a photo together?</div>
  <div class="callout-top"   id="q9">The day we started dating?</div>
  <div class="callout-right" id="q10">Something we often get forced to watch together?</div>

  <!-- OMI -->
  <input class="cell" id="o1" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="h1" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="i1" maxlength="1" autocomplete="off" inputmode="text">

  <!-- MAJOR -->
  <input class="cell" id="h2" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="h3" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="h4" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="h5" maxlength="1" autocomplete="off" inputmode="text">

  <!-- JUNE -->
  <input class="cell" id="v2" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="v3" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="v4" maxlength="1" autocomplete="off" inputmode="text">

  <!-- BOARDGAME -->
  <input class="cell" id="bgB"  maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="bgO"  maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="bgA1" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="bgD"  maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="bgG"  maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="bgA2" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="bgM"  maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="bgE"  maxlength="1" autocomplete="off" inputmode="text">

  <!-- TEERAK -->
  <input class="cell" id="t1" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="t2" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="t4" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="t6" maxlength="1" autocomplete="off" inputmode="text">

  <!-- ELEPHANT -->
  <input class="cell" id="el1" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="el2" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="el4" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="el5" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="el6" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="el7" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="el8" maxlength="1" autocomplete="off" inputmode="text">

  <!-- SHABU -->
  <input class="cell" id="sh1" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="sh2" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="sh3" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="sh5" maxlength="1" autocomplete="off" inputmode="text">

  <!-- SEA -->
  <input class="cell" id="se1" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="se2" maxlength="1" autocomplete="off" inputmode="text">

  <!-- EIGHT -->
  <input class="cell" id="ei1" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="ei2" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="ei3" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="ei4" maxlength="1" autocomplete="off" inputmode="text">

  <!-- ANIME -->
  <input class="cell" id="an2" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="an3" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="an4" maxlength="1" autocomplete="off" inputmode="text">
  <input class="cell" id="an5" maxlength="1" autocomplete="off" inputmode="text">
</div>

<div id="winOverlay" class="overlay" hidden>
  <div class="modal" role="dialog" aria-modal="true" aria-label="Love message">
    <div class="title">üíñ Happy Valentine Day üíñ</div>
    <div class="msg">
      ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡πÄ‡∏à‡∏≠‡∏Å‡∏±‡∏ô<br>
      ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏´‡∏•‡∏≤‡∏¢‡πÜ‡∏™‡∏¥‡πà‡∏á‡∏´‡∏•‡∏≤‡∏¢‡πÜ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô<br>
      ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï<br><br>
      ‡∏£‡∏±‡∏Å‡πÄ‡∏ö‡πâ‡∏ô‡∏ã‡πå‡∏ô‡∏∞ üíñ
    </div>
    <button id="closeWin" class="btn">Close</button>
  </div>
</div>

<script>
  const expected = {
    o1:"o", h1:"m", i1:"i",
    h2:"a", h3:"j", h4:"o", h5:"r",
    v2:"u", v3:"n", v4:"e",
    bgB:"b", bgO:"o", bgA1:"a", bgD:"d", bgG:"g", bgA2:"a", bgM:"m", bgE:"e",
    t1:"t", t2:"e", t4:"r", t6:"k",
    el1:"e", el2:"l", el4:"p", el5:"h", el6:"a", el7:"n", el8:"t",
    sh1:"s", sh2:"h", sh3:"a", sh5:"u",
    se1:"s", se2:"e",
    ei1:"e", ei2:"i", ei3:"g", ei4:"h",
    an2:"n", an3:"i", an4:"m", an5:"e",
  };

  const els = Object.keys(expected).map(id => document.getElementById(id)).filter(Boolean);

  function setState(el, state){
    el.classList.remove("correct","wrong");
    if (state) el.classList.add(state);
  }

  function getPos(el){
    const cs = getComputedStyle(el);
    const r = parseInt(cs.gridRowStart, 10);
    const c = parseInt(cs.gridColumnStart, 10);
    return { r: Number.isFinite(r) ? r : 999, c: Number.isFinite(c) ? c : 999 };
  }

  const ordered = [...els].sort((a,b)=>{
    const pa = getPos(a), pb = getPos(b);
    return (pa.r - pb.r) || (pa.c - pb.c);
  });
  const idxById = new Map(ordered.map((el,i)=>[el.id,i]));

  function focusNext(el){
    const i = idxById.get(el.id);
    const next = (i==null) ? null : ordered[i+1];
    if (next) next.focus();
  }
  function focusPrev(el){
    const i = idxById.get(el.id);
    const prev = (i==null) ? null : ordered[i-1];
    if (prev) prev.focus();
  }

  function sanitizeChar(ch){
    const up = (ch || "").toUpperCase();
    const m = up.match(/[A-Z]/);
    return m ? m[0] : "";
  }

  function checkOne(el){
    const want = expected[el.id];
    const got = (el.value || "").toLowerCase();
    if (!got) { setState(el, null); return; }
    setState(el, got === want ? "correct" : "wrong");
  }

  // ===== Romantic Background Melody (start on first input, loop forever) =====
  let audioCtx;
  let masterGain;
  let musicStarted = false;

  const melody = [
    440, 523, 659, 523,
    392, 523, 659, 523,
    349, 440, 523, 440,
    392, 440, 523, 659
  ];

  function ensureAudio(){
    if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    if (!masterGain){
      masterGain = audioCtx.createGain();
      masterGain.connect(audioCtx.destination);
      masterGain.gain.value = 0;
    }
  }

  function playNote(freq, time){
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();

    osc.type = "sine";
    osc.frequency.value = freq;

    osc.connect(gain);
    gain.connect(masterGain);

    gain.gain.setValueAtTime(0.0001, time);
    gain.gain.linearRampToValueAtTime(0.10, time + 0.04);
    gain.gain.exponentialRampToValueAtTime(0.0001, time + 1.1);

    osc.start(time);
    osc.stop(time + 1.12);
  }

  function startMusic(){
    if (musicStarted) return;
    musicStarted = true;

    ensureAudio();
    if (audioCtx.state === "suspended") audioCtx.resume();

    masterGain.gain.cancelScheduledValues(audioCtx.currentTime);
    masterGain.gain.setValueAtTime(0.0001, audioCtx.currentTime);
    masterGain.gain.linearRampToValueAtTime(0.13, audioCtx.currentTime + 2);

    let i = 0;
    setInterval(() => {
      playNote(melody[i], audioCtx.currentTime);
      i = (i + 1) % melody.length;
    }, 600);
  }

  // ===== WIN CHECK =====
  let winShown = false;

  function showWin(){
    if (winShown) return;
    winShown = true;

    const overlay = document.getElementById("winOverlay");
    overlay.hidden = false;

    const btn = document.getElementById("closeWin");
    btn.focus();

    btn.onclick = () => { overlay.hidden = true; };

    overlay.addEventListener("click", (e) => {
      if (e.target === overlay) overlay.hidden = true;
    }, { once: true });

    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") overlay.hidden = true;
    }, { once: true });
  }

  function checkAllSolved(){
    const allCorrect = ordered.every(el =>
      (el.value || "").toLowerCase() === expected[el.id]
    );
    if (allCorrect) showWin();
  }

  ordered.forEach(el => {
    el.addEventListener("input", () => {
      startMusic();
      el.value = sanitizeChar(el.value);
      checkOne(el);
      checkAllSolved();
      if (el.value) focusNext(el);
    });

    el.addEventListener("keydown", (e) => {
      if (e.key === "Backspace" && !el.value) {
        e.preventDefault();
        focusPrev(el);
        return;
      }
      if (e.key === "ArrowLeft")  { e.preventDefault(); focusPrev(el); return; }
      if (e.key === "ArrowRight") { e.preventDefault(); focusNext(el); return; }
    });

    el.addEventListener("focus", () => el.select());
  });

  document.addEventListener("keydown", (e) => {
    if (e.key === "Enter") ordered.forEach(checkOne);
  });

  (document.getElementById("sh1") || ordered[0] || document.getElementById("h3"))?.focus();
</script>

</body>
</html>
